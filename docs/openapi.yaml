openapi: 3.0.0
info:
  title: Shigawire API
  version: 1.0.0
  description: API for session capture, replay, and event streaming
servers:
  - url: http://localhost:8080/api/v1
    description: Local development server
paths:
  /projects:
    get:
      summary: List all projects
      tags:
        - Projects
      responses:
        "200":
          description: A list of projects
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Project"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      summary: Create a new project
      tags:
        - Projects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProjectInput"
      responses:
        "200":
          description: Project created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Project"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /projects/{projectId}:
    parameters:
      - name: projectId
        in: path
        required: true
        schema:
          type: string
    get:
      summary: Get a project by ID
      tags:
        - Projects
      responses:
        "200":
          description: A project
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Project"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    put:
      summary: Update a project by ID
      tags:
        - Projects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProjectInput"
      responses:
        "200":
          description: Project updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Project"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    delete:
      summary: Delete a project by ID
      tags:
        - Projects
      responses:
        "200":
          description: Project deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /projects/{projectId}/sessions:
    parameters:
      - name: projectId
        in: path
        required: true
        schema:
          type: string
    get:
      summary: List all sessions for a project
      tags:
        - Sessions
      responses:
        "200":
          description: A list of sessions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Session"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      summary: Create a new session within a project
      tags:
        - Sessions
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SessionInput"
      responses:
        "200":
          description: Session created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Session"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /projects/{projectId}/sessions/{sessionId}:
    parameters:
      - name: projectId
        in: path
        required: true
        schema:
          type: string
      - name: sessionId
        in: path
        required: true
        schema:
          type: string
    get:
      summary: Get a session by ID
      tags:
        - Sessions
      responses:
        "200":
          description: A session
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Session"
        "404":
          description: Session or project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    delete:
      summary: Delete a session by ID
      tags:
        - Sessions
      responses:
        "200":
          description: Session deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "404":
          description: Session or project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /projects/{projectId}/sessions/{sessionId}/record/start:
    parameters:
      - name: projectId
        in: path
        required: true
        schema:
          type: string
      - name: sessionId
        in: path
        required: true
        schema:
          type: string
    post:
      summary: Start recording events for a session
      tags:
        - Recording Control
      responses:
        "200":
          description: Recording started
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "404":
          description: Session or project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Recording already in progress
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /projects/{projectId}/sessions/{sessionId}/record/stop:
    parameters:
      - name: projectId
        in: path
        required: true
        schema:
          type: string
      - name: sessionId
        in: path
        required: true
        schema:
          type: string
    post:
      summary: Stop recording events for a session
      tags:
        - Recording Control
      responses:
        "200":
          description: Recording stopped
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "404":
          description: Session or project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Recording not in progress
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /projects/{projectId}/sessions/{sessionId}/record/status:
    parameters:
      - name: projectId
        in: path
        required: true
        schema:
          type: string
      - name: sessionId
        in: path
        required: true
        schema:
          type: string
    get:
      summary: Get recording status for a session
      tags:
        - Recording Control
      responses:
        "200":
          description: Recording status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RecordingStatus"
        "404":
          description: Session or project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /record/status:
    get:
      summary: Get global recording status
      tags:
        - Recording Control
      responses:
        "200":
          description: Global recording status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RecordingStatus"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /projects/{projectId}/sessions/{sessionId}/events:
    parameters:
      - name: projectId
        in: path
        required: true
        schema:
          type: string
      - name: sessionId
        in: path
        required: true
        schema:
          type: string
    get:
      summary: List all events for a session
      tags:
        - Events
      responses:
        "200":
          description: A list of events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Event"
        "404":
          description: Session or project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      summary: Seed an event into a session
      tags:
        - Events
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EventInput"
      responses:
        "200":
          description: Event seeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Event"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Session or project not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /sessions/{id}/replay/start:
    post:
      summary: Start replaying a session
      tags:
        - Replay Control
      responses:
        "200":
          description: Replay started
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "404":
          description: Session not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /api/replay/{replayId}/pause:
    post:
      summary: Pause a replay
      tags:
        - Replay Control
      responses:
        "200":
          description: Replay paused
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "404":
          description: Replay not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /api/replay/{replayId}/step:
    post:
      summary: Step a replay
      tags:
        - Replay Control
      responses:
        "200":
          description: Replay stepped
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "404":
          description: ReplayId not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /api/replay/{replayId}/speed:
    post:
      summary: Set the speed of a replay
      tags:
        - Replay Control
      responses:
        "200":
          description: Replay speed set
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "404":
          description: ReplayId not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /api/replay/{replayId}/events:
    websocket:
      summary: Get events for a replay
      tags:
        - Replay Control
      responses:
        "200":
          description: Events received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "404":
          description: Replay not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /swagger/{any}:
    get:
      summary: Swagger UI
      tags:
        - Docs
      parameters:
        - name: any
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Swagger UI HTML
          content:
            text/html:
              schema:
                type: string

  /openapi.yaml:
    get:
      summary: Get OpenAPI specification
      tags:
        - Docs
      responses:
        "200":
          description: OpenAPI YAML spec
          content:
            application/yaml:
              schema:
                type: string

  tags:
    - name: Projects
      description: Manage projects.
    - name: Sessions
      description: Manage and query sessions within a project.
    - name: Recording Control
      description: Start, stop, and query recording state for a session.
    - name: Events
      description: List and seed events within a session.
    - name: Replay Control
      description: Control the replay process for sessions. Start and stop replaying  events for a specific session.
    - name: Docs
      description: API documentation endpoints.